<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html;charset=utf-8" /><link rel="stylesheet" href="{$Think.const.CSS_URL}/highlight.css"></head><div class="highlight"><pre><span class="lineno">  1 </span><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="lineno">  2 </span><span class="cp">#include &lt;stdlib.h&gt;</span>
<span class="lineno">  3 </span><span class="cp">#include &lt;string.h&gt;</span>
<span class="lineno">  4 </span>
<span class="lineno">  5 </span>
<span class="lineno">  6 </span><span class="k">typedef</span> <span class="kt">int</span> <span class="n">T</span><span class="p">;</span>
<span class="lineno">  7 </span><span class="k">typedef</span> <span class="nf">bool</span> <span class="p">(</span><span class="o">*</span><span class="kt">cmp_func_t</span><span class="p">)(</span><span class="k">const</span> <span class="n">T</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">T</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">);</span> 
<span class="lineno">  8 </span>
<span class="lineno">  9 </span><span class="kt">void</span> <span class="nf">Swap</span><span class="p">(</span><span class="n">T</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="n">T</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
<span class="lineno"> 10 </span><span class="p">{</span>
<span class="lineno"> 11 </span>  <span class="n">T</span> <span class="n">t</span><span class="p">;</span>
<span class="lineno"> 12 </span>  <span class="n">t</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span>
<span class="lineno"> 13 </span>  <span class="n">a</span> <span class="o">=</span> <span class="n">b</span><span class="p">;</span>
<span class="lineno"> 14 </span>  <span class="n">b</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span>
<span class="lineno"> 15 </span><span class="p">}</span>
<span class="lineno"> 16 </span>
<span class="lineno"> 17 </span><span class="c1">// operation &lt;   order</span>
<span class="lineno"> 18 </span><span class="kt">bool</span> <span class="nf">cmp_less</span><span class="p">(</span><span class="k">const</span> <span class="n">T</span> <span class="o">&amp;</span><span class="n">leftData</span><span class="p">,</span> <span class="k">const</span> <span class="n">T</span> <span class="o">&amp;</span><span class="n">rightData</span><span class="p">)</span>
<span class="lineno"> 19 </span><span class="p">{</span>
<span class="lineno"> 20 </span>  <span class="k">return</span> <span class="p">(</span><span class="n">rightData</span> <span class="o">-</span> <span class="n">leftData</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 21 </span><span class="p">}</span>
<span class="lineno"> 22 </span>
<span class="lineno"> 23 </span><span class="c1">// operation &gt;  reversed order</span>
<span class="lineno"> 24 </span><span class="kt">bool</span> <span class="nf">cmp_bigger</span><span class="p">(</span><span class="k">const</span> <span class="n">T</span> <span class="o">&amp;</span><span class="n">leftData</span><span class="p">,</span> <span class="k">const</span> <span class="n">T</span> <span class="o">&amp;</span><span class="n">rightData</span><span class="p">)</span>
<span class="lineno"> 25 </span><span class="p">{</span>
<span class="lineno"> 26 </span>  <span class="k">return</span> <span class="p">(</span><span class="n">rightData</span> <span class="o">-</span> <span class="n">leftData</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="lineno"> 27 </span><span class="p">}</span>
<span class="lineno"> 28 </span>
<span class="lineno"> 29 </span><span class="kt">void</span> <span class="nf">printArr</span><span class="p">(</span><span class="n">T</span> <span class="k">const</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
<span class="lineno"> 30 </span><span class="p">{</span>
<span class="lineno"> 31 </span>  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="lineno"> 32 </span>  <span class="p">{</span>
<span class="lineno"> 33 </span>    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d &quot;</span><span class="p">,</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="lineno"> 34 </span>  <span class="p">}</span>
<span class="lineno"> 35 </span>  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="lineno"> 36 </span><span class="p">}</span>
<span class="lineno"> 37 </span>
<span class="lineno"> 38 </span>
<span class="lineno"> 39 </span><span class="cm">/**********************************************</span>
<span class="lineno"> 40 </span><span class="cm">***************** Select  Sort  ***************</span>
<span class="lineno"> 41 </span><span class="cm">**********************************************/</span>
<span class="lineno"> 42 </span><span class="kt">void</span> <span class="nf">SelectSort</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">cmp_func_t</span> <span class="n">cmp_fn</span><span class="p">)</span>
<span class="lineno"> 43 </span><span class="p">{</span>
<span class="lineno"> 44 </span>  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">minmaxIndex</span><span class="p">;</span>
<span class="lineno"> 45 </span>  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="lineno"> 46 </span>  <span class="p">{</span>
<span class="lineno"> 47 </span>    <span class="n">minmaxIndex</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
<span class="lineno"> 48 </span>    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
<span class="lineno"> 49 </span>    <span class="p">{</span>
<span class="lineno"> 50 </span>      <span class="k">if</span><span class="p">(</span> <span class="n">cmp_fn</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="n">minmaxIndex</span><span class="p">])</span> <span class="p">)</span>
<span class="lineno"> 51 </span>      <span class="p">{</span>
<span class="lineno"> 52 </span>        <span class="n">minmaxIndex</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
<span class="lineno"> 53 </span>      <span class="p">}</span>
<span class="lineno"> 54 </span>    <span class="p">}</span>
<span class="lineno"> 55 </span>    <span class="c1">// find the min/max from unsorted list,</span>
<span class="lineno"> 56 </span>    <span class="c1">// swap it with the first element of unsorted list</span>
<span class="lineno"> 57 </span>    <span class="k">if</span><span class="p">(</span><span class="n">minmaxIndex</span> <span class="o">!=</span> <span class="n">i</span><span class="p">)</span>
<span class="lineno"> 58 </span>      <span class="n">Swap</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">minmaxIndex</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="lineno"> 59 </span>  <span class="p">}</span>
<span class="lineno"> 60 </span><span class="p">}</span>
<span class="lineno"> 61 </span>
<span class="lineno"> 62 </span>
<span class="lineno"> 63 </span><span class="cm">/**********************************************</span>
<span class="lineno"> 64 </span><span class="cm">***************** Insert  Sort  ***************</span>
<span class="lineno"> 65 </span><span class="cm">**********************************************/</span>
<span class="lineno"> 66 </span><span class="kt">void</span> <span class="nf">InsertSort</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">cmp_func_t</span> <span class="n">cmp_fn</span><span class="p">)</span>
<span class="lineno"> 67 </span><span class="p">{</span>
<span class="lineno"> 68 </span>  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span>
<span class="lineno"> 69 </span>    <span class="n">temp</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="lineno"> 70 </span>  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="lineno"> 71 </span>  <span class="p">{</span>
<span class="lineno"> 72 </span>    <span class="n">temp</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="lineno"> 73 </span>    <span class="c1">// right shifting element while searching insert point</span>
<span class="lineno"> 74 </span>    <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">--</span><span class="p">)</span>
<span class="lineno"> 75 </span>    <span class="p">{</span>
<span class="lineno"> 76 </span>      <span class="k">if</span><span class="p">(</span> <span class="n">cmp_fn</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="p">)</span>
<span class="lineno"> 77 </span>        <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="lineno"> 78 </span>      <span class="k">else</span>
<span class="lineno"> 79 </span>        <span class="k">break</span><span class="p">;</span>
<span class="lineno"> 80 </span>    <span class="p">}</span>
<span class="lineno"> 81 </span>    <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span>
<span class="lineno"> 82 </span>  <span class="p">}</span>
<span class="lineno"> 83 </span><span class="p">}</span>
<span class="lineno"> 84 </span>
<span class="lineno"> 85 </span>
<span class="lineno"> 86 </span><span class="cm">/**********************************************</span>
<span class="lineno"> 87 </span><span class="cm">***************** Bubble  Sort  ***************</span>
<span class="lineno"> 88 </span><span class="cm">**********************************************/</span>
<span class="lineno"> 89 </span><span class="kt">void</span> <span class="nf">BubbleSort</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">cmp_func_t</span> <span class="n">cmp_fn</span><span class="p">)</span>
<span class="lineno"> 90 </span><span class="p">{</span>
<span class="lineno"> 91 </span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
<span class="lineno"> 92 </span>  <span class="kt">bool</span> <span class="n">isSwaped</span><span class="p">;</span>
<span class="lineno"> 93 </span>  <span class="c1">// n-1 times</span>
<span class="lineno"> 94 </span>  <span class="k">while</span><span class="p">(</span><span class="o">--</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="lineno"> 95 </span>  <span class="p">{</span>
<span class="lineno"> 96 </span>    <span class="n">isSwaped</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="lineno"> 97 </span>    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="lineno"> 98 </span>    <span class="p">{</span>
<span class="lineno"> 99 </span>      <span class="k">if</span><span class="p">(</span> <span class="n">cmp_fn</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">)</span>
<span class="lineno">100 </span>      <span class="p">{</span>
<span class="lineno">101 </span>        <span class="n">Swap</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="lineno">102 </span>        <span class="n">isSwaped</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="lineno">103 </span>      <span class="p">}</span>
<span class="lineno">104 </span>    <span class="p">}</span>
<span class="lineno">105 </span>    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">isSwaped</span><span class="p">)</span>
<span class="lineno">106 </span>      <span class="k">break</span><span class="p">;</span>
<span class="lineno">107 </span>  <span class="p">}</span>
<span class="lineno">108 </span><span class="p">}</span>
<span class="lineno">109 </span>
<span class="lineno">110 </span><span class="kt">void</span> <span class="nf">Bubble2Sort</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">cmp_func_t</span> <span class="n">cmp_fn</span><span class="p">)</span>
<span class="lineno">111 </span><span class="p">{</span>
<span class="lineno">112 </span>  <span class="kt">int</span> <span class="n">low</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">113 </span>  <span class="kt">int</span> <span class="n">high</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
<span class="lineno">114 </span>  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">;</span>
<span class="lineno">115 </span>  <span class="k">while</span><span class="p">(</span><span class="n">low</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">)</span>
<span class="lineno">116 </span>  <span class="p">{</span>
<span class="lineno">117 </span>    <span class="c1">// 正向部分</span>
<span class="lineno">118 </span>    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">low</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">high</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="lineno">119 </span>    <span class="p">{</span>
<span class="lineno">120 </span>      <span class="k">if</span><span class="p">(</span> <span class="n">cmp_fn</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">)</span>
<span class="lineno">121 </span>      <span class="p">{</span>
<span class="lineno">122 </span>        <span class="n">Swap</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span>
<span class="lineno">123 </span>        <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// 待排序尾端</span>
<span class="lineno">124 </span>      <span class="p">}</span>
<span class="lineno">125 </span>    <span class="p">}</span>
<span class="lineno">126 </span>    <span class="n">high</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span>
<span class="lineno">127 </span>
<span class="lineno">128 </span>    <span class="c1">// 反向部分</span>
<span class="lineno">129 </span>    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">high</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="n">low</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span>
<span class="lineno">130 </span>    <span class="p">{</span>
<span class="lineno">131 </span>      <span class="k">if</span><span class="p">(</span> <span class="n">cmp_fn</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
<span class="lineno">132 </span>      <span class="p">{</span>
<span class="lineno">133 </span>        <span class="n">Swap</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
<span class="lineno">134 </span>        <span class="n">t</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// 待排序始端</span>
<span class="lineno">135 </span>      <span class="p">}</span>
<span class="lineno">136 </span>    <span class="p">}</span>
<span class="lineno">137 </span>    <span class="n">low</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span>
<span class="lineno">138 </span>  <span class="p">}</span>
<span class="lineno">139 </span>
<span class="lineno">140 </span><span class="p">}</span>
<span class="lineno">141 </span>
<span class="lineno">142 </span>
<span class="lineno">143 </span><span class="cm">/**********************************************</span>
<span class="lineno">144 </span><span class="cm">***************** Merge  Sort  ***************</span>
<span class="lineno">145 </span><span class="cm">**********************************************/</span>
<span class="lineno">146 </span><span class="kt">void</span> <span class="nf">Merge</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="n">T</span> <span class="o">*</span><span class="n">temp</span><span class="p">,</span> <span class="kt">int</span> <span class="n">first</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">last</span><span class="p">,</span> <span class="kt">cmp_func_t</span> <span class="n">cmp_fn</span><span class="p">)</span>
<span class="lineno">147 </span><span class="p">{</span>
<span class="lineno">148 </span>  <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">first</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
<span class="lineno">149 </span>  <span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">150 </span>  <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">mid</span> <span class="o">&amp;&amp;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">last</span><span class="p">)</span>
<span class="lineno">151 </span>  <span class="p">{</span>
<span class="lineno">152 </span>    <span class="k">if</span><span class="p">(</span> <span class="n">cmp_fn</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="p">)</span>  
<span class="lineno">153 </span>      <span class="n">temp</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">];</span>   <span class="c1">// 取arr[i]和arr[j]中较小/较大者放入temp[k]</span>
<span class="lineno">154 </span>    <span class="k">else</span>
<span class="lineno">155 </span>      <span class="n">temp</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="o">++</span><span class="p">];</span>
<span class="lineno">156 </span>  <span class="p">}</span>
<span class="lineno">157 </span>
<span class="lineno">158 </span>  <span class="k">while</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;=</span> <span class="n">mid</span><span class="p">)</span>
<span class="lineno">159 </span>    <span class="n">temp</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="o">++</span><span class="p">];</span> <span class="c1">// 若第一个子序列没处理完，则进行收尾处理</span>
<span class="lineno">160 </span>  <span class="k">while</span><span class="p">(</span><span class="n">j</span> <span class="o">&lt;=</span> <span class="n">last</span><span class="p">)</span>
<span class="lineno">161 </span>    <span class="n">temp</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="o">++</span><span class="p">];</span> <span class="c1">// 若第二个子序列没处理完，则进行收尾处理</span>
<span class="lineno">162 </span>
<span class="lineno">163 </span>  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="lineno">164 </span>    <span class="n">arr</span><span class="p">[</span><span class="n">first</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="lineno">165 </span><span class="p">}</span>
<span class="lineno">166 </span>
<span class="lineno">167 </span><span class="kt">void</span> <span class="nf">MergeSort</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="n">T</span> <span class="o">*</span><span class="n">temp</span><span class="p">,</span> <span class="kt">int</span> <span class="n">first</span><span class="p">,</span> <span class="kt">int</span> <span class="n">last</span><span class="p">,</span> <span class="kt">cmp_func_t</span> <span class="n">cmp_fn</span><span class="p">)</span>
<span class="lineno">168 </span><span class="p">{</span>
<span class="lineno">169 </span>  <span class="k">if</span><span class="p">(</span><span class="n">first</span> <span class="o">&lt;</span> <span class="n">last</span><span class="p">)</span>
<span class="lineno">170 </span>  <span class="p">{</span>
<span class="lineno">171 </span>    <span class="kt">int</span> <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="n">last</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
<span class="lineno">172 </span>    <span class="n">MergeSort</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">cmp_fn</span><span class="p">);</span>
<span class="lineno">173 </span>    <span class="n">MergeSort</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">last</span><span class="p">,</span> <span class="n">cmp_fn</span><span class="p">);</span>
<span class="lineno">174 </span>    <span class="n">Merge</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">last</span><span class="p">,</span> <span class="n">cmp_fn</span><span class="p">);</span>
<span class="lineno">175 </span>
<span class="lineno">176 </span>  <span class="p">}</span>
<span class="lineno">177 </span><span class="p">}</span>
<span class="lineno">178 </span>
<span class="lineno">179 </span>
<span class="lineno">180 </span><span class="c1">// 非递归</span>
<span class="lineno">181 </span><span class="kt">void</span> <span class="nf">MergeSort2</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="n">T</span> <span class="o">*</span><span class="n">temp</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">cmp_func_t</span> <span class="n">cmp_fn</span><span class="p">)</span>
<span class="lineno">182 </span><span class="p">{</span>
<span class="lineno">183 </span>  <span class="kt">int</span> <span class="n">first</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">last</span><span class="p">;</span>
<span class="lineno">184 </span>  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">step</span><span class="p">;</span>
<span class="lineno">185 </span>  <span class="c1">// step = 1, 2, 4, 8, ... log(n)</span>
<span class="lineno">186 </span>  <span class="k">for</span><span class="p">(</span><span class="n">step</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">step</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">step</span> <span class="o">*=</span> <span class="mi">2</span><span class="p">)</span>
<span class="lineno">187 </span>  <span class="p">{</span>
<span class="lineno">188 </span>    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="o">*</span><span class="n">step</span><span class="p">)</span>
<span class="lineno">189 </span>    <span class="p">{</span>
<span class="lineno">190 </span>      <span class="n">first</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
<span class="lineno">191 </span>      <span class="n">last</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
<span class="lineno">192 </span>      <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="n">last</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
<span class="lineno">193 </span>      <span class="k">if</span> <span class="p">(</span><span class="n">mid</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">)</span>
<span class="lineno">194 </span>        <span class="k">break</span><span class="p">;</span>
<span class="lineno">195 </span>      <span class="k">if</span><span class="p">(</span><span class="n">last</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">)</span>
<span class="lineno">196 </span>        <span class="n">last</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
<span class="lineno">197 </span>
<span class="lineno">198 </span>      <span class="n">Merge</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">last</span><span class="p">,</span> <span class="n">cmp_fn</span><span class="p">);</span>
<span class="lineno">199 </span>    <span class="p">}</span>
<span class="lineno">200 </span>  <span class="p">}</span>
<span class="lineno">201 </span><span class="p">}</span>
<span class="lineno">202 </span>
<span class="lineno">203 </span>
<span class="lineno">204 </span><span class="cm">/**********************************************</span>
<span class="lineno">205 </span><span class="cm">***************** Quick  Sort  ***************</span>
<span class="lineno">206 </span><span class="cm">**********************************************/</span>
<span class="lineno">207 </span><span class="kt">int</span> <span class="nf">Partition</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">start</span><span class="p">,</span> <span class="kt">int</span> <span class="n">end</span><span class="p">,</span> <span class="kt">cmp_func_t</span> <span class="n">cmp_fn</span><span class="p">)</span>
<span class="lineno">208 </span><span class="p">{</span>
<span class="lineno">209 </span>  <span class="c1">// 取中间值为轴值</span>
<span class="lineno">210 </span>  <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">end</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">;</span>
<span class="lineno">211 </span>  <span class="n">Swap</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">end</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="n">index</span><span class="p">]);</span>
<span class="lineno">212 </span>  <span class="kt">int</span> <span class="n">pivot</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">end</span><span class="p">];</span> <span class="c1">// 轴值</span>
<span class="lineno">213 </span>
<span class="lineno">214 </span>  <span class="c1">// 分割</span>
<span class="lineno">215 </span>  <span class="kt">int</span> <span class="n">leftId</span> <span class="o">=</span> <span class="n">start</span><span class="p">;</span>
<span class="lineno">216 </span>  <span class="k">for</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="n">start</span><span class="p">;</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">;</span> <span class="o">++</span><span class="n">index</span><span class="p">)</span>
<span class="lineno">217 </span>  <span class="p">{</span>
<span class="lineno">218 </span>    <span class="k">if</span><span class="p">(</span> <span class="n">cmp_fn</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">pivot</span><span class="p">)</span> <span class="p">)</span>
<span class="lineno">219 </span>    <span class="p">{</span>
<span class="lineno">220 </span>      <span class="k">if</span><span class="p">(</span><span class="n">leftId</span> <span class="o">!=</span> <span class="n">index</span><span class="p">)</span>
<span class="lineno">221 </span>        <span class="n">Swap</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="n">leftId</span><span class="p">]);</span>
<span class="lineno">222 </span>      <span class="o">++</span><span class="n">leftId</span><span class="p">;</span>
<span class="lineno">223 </span>    <span class="p">}</span>
<span class="lineno">224 </span>  <span class="p">}</span>
<span class="lineno">225 </span>
<span class="lineno">226 </span>  <span class="n">Swap</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">leftId</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="n">end</span><span class="p">]);</span>
<span class="lineno">227 </span>  <span class="k">return</span> <span class="n">leftId</span><span class="p">;</span>
<span class="lineno">228 </span><span class="p">}</span>
<span class="lineno">229 </span>
<span class="lineno">230 </span><span class="kt">void</span> <span class="nf">QuickSort</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">start</span><span class="p">,</span> <span class="kt">int</span> <span class="n">end</span><span class="p">,</span> <span class="kt">cmp_func_t</span> <span class="n">cmp_fn</span><span class="p">)</span>
<span class="lineno">231 </span><span class="p">{</span>
<span class="lineno">232 </span>  <span class="k">if</span><span class="p">(</span><span class="n">start</span> <span class="o">==</span> <span class="n">end</span><span class="p">)</span>
<span class="lineno">233 </span>    <span class="k">return</span><span class="p">;</span>
<span class="lineno">234 </span>
<span class="lineno">235 </span>  <span class="kt">int</span> <span class="n">index</span> <span class="o">=</span> <span class="n">Partition</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">cmp_fn</span><span class="p">);</span>
<span class="lineno">236 </span>  <span class="k">if</span><span class="p">(</span><span class="n">index</span> <span class="o">&gt;</span> <span class="n">start</span><span class="p">)</span>
<span class="lineno">237 </span>    <span class="n">QuickSort</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">index</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmp_fn</span><span class="p">);</span>
<span class="lineno">238 </span>  <span class="k">if</span><span class="p">(</span><span class="n">index</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">)</span>
<span class="lineno">239 </span>    <span class="n">QuickSort</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">index</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">cmp_fn</span><span class="p">);</span>
<span class="lineno">240 </span>
<span class="lineno">241 </span><span class="p">}</span>
<span class="lineno">242 </span>
<span class="lineno">243 </span>
<span class="lineno">244 </span><span class="cm">/**********************************************</span>
<span class="lineno">245 </span><span class="cm">***************** Shell  Sort  ***************</span>
<span class="lineno">246 </span><span class="cm">**********************************************/</span>
<span class="lineno">247 </span><span class="kt">void</span> <span class="nf">ShellSort</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">cmp_func_t</span> <span class="n">cmp_fn</span><span class="p">)</span>
<span class="lineno">248 </span><span class="p">{</span>
<span class="lineno">249 </span>  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">gap</span><span class="p">;</span>
<span class="lineno">250 </span>  <span class="n">T</span> <span class="n">temp</span><span class="p">;</span>
<span class="lineno">251 </span>  <span class="k">for</span><span class="p">(</span><span class="n">gap</span> <span class="o">=</span> <span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="n">gap</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">gap</span> <span class="o">/=</span> <span class="mi">2</span><span class="p">)</span>
<span class="lineno">252 </span>  <span class="p">{</span>
<span class="lineno">253 </span>    <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">gap</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="lineno">254 </span>    <span class="p">{</span>
<span class="lineno">255 </span>      <span class="n">temp</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="lineno">256 </span>      <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">-</span><span class="n">gap</span><span class="p">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">-=</span> <span class="n">gap</span><span class="p">)</span>
<span class="lineno">257 </span>      <span class="p">{</span>
<span class="lineno">258 </span>        <span class="k">if</span><span class="p">(</span> <span class="n">cmp_fn</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="p">)</span>
<span class="lineno">259 </span>          <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">gap</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="lineno">260 </span>        <span class="k">else</span>
<span class="lineno">261 </span>          <span class="k">break</span><span class="p">;</span>
<span class="lineno">262 </span>      <span class="p">}</span>
<span class="lineno">263 </span>      <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">gap</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span>
<span class="lineno">264 </span>    <span class="p">}</span>
<span class="lineno">265 </span>  <span class="p">}</span>
<span class="lineno">266 </span><span class="p">}</span>
<span class="lineno">267 </span>
<span class="lineno">268 </span>
<span class="lineno">269 </span><span class="cm">/**********************************************</span>
<span class="lineno">270 </span><span class="cm">***************** Heap    Sort  ***************</span>
<span class="lineno">271 </span><span class="cm">**********************************************/</span>
<span class="lineno">272 </span><span class="c1">// 新加入结点，其父结点为(i-1) / 2</span>
<span class="lineno">273 </span><span class="kt">void</span> <span class="nf">HeapFixUp</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="kt">cmp_func_t</span> <span class="n">cmp_fn</span><span class="p">)</span>
<span class="lineno">274 </span><span class="p">{</span>
<span class="lineno">275 </span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span>
<span class="lineno">276 </span>  <span class="n">T</span> <span class="n">temp</span><span class="p">;</span>
<span class="lineno">277 </span>  <span class="c1">// j 为i的父结点</span>
<span class="lineno">278 </span>  <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="lineno">279 </span>  <span class="p">{</span>
<span class="lineno">280 </span>    <span class="k">if</span><span class="p">(</span> <span class="n">cmp_fn</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span> <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="p">)</span>
<span class="lineno">281 </span>    <span class="p">{</span>
<span class="lineno">282 </span>      <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>  <span class="c1">// 把较大(minHeap)/较小(maxHeap)的父结点往下移动，替换子结点</span>
<span class="lineno">283 </span>      <span class="n">i</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>  <span class="c1">// 更新当前结点为新结点索引</span>
<span class="lineno">284 </span>    <span class="p">}</span>
<span class="lineno">285 </span>    <span class="k">else</span>
<span class="lineno">286 </span>      <span class="k">break</span><span class="p">;</span>
<span class="lineno">287 </span>  <span class="p">}</span>
<span class="lineno">288 </span>  <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span>
<span class="lineno">289 </span><span class="p">}</span>
<span class="lineno">290 </span>
<span class="lineno">291 </span><span class="c1">// 在最小/大堆中加入新的数据num</span>
<span class="lineno">292 </span><span class="kt">void</span> <span class="nf">HeapAddNumber</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="n">T</span> <span class="n">num</span><span class="p">,</span> <span class="kt">cmp_func_t</span> <span class="n">cmp_fn</span><span class="p">)</span>
<span class="lineno">293 </span><span class="p">{</span>
<span class="lineno">294 </span>  <span class="n">arr</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span><span class="p">;</span>
<span class="lineno">295 </span>  <span class="n">HeapFixUp</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">cmp_fn</span><span class="p">);</span>
<span class="lineno">296 </span><span class="p">}</span>
<span class="lineno">297 </span>
<span class="lineno">298 </span><span class="c1">//对a[i]进行自上而下的重建堆，n为结点总数,类似于插入排序 </span>
<span class="lineno">299 </span><span class="kt">void</span> <span class="nf">HeapFixDown</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">cmp_func_t</span> <span class="n">cmp_fn</span><span class="p">)</span>
<span class="lineno">300 </span><span class="p">{</span>
<span class="lineno">301 </span>  <span class="kt">int</span> <span class="n">j</span><span class="p">;</span>
<span class="lineno">302 </span>  <span class="n">T</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="lineno">303 </span>  <span class="c1">// j = 2*i + 1 为 i 的子结点</span>
<span class="lineno">304 </span>  <span class="k">for</span><span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="lineno">305 </span>  <span class="p">{</span>
<span class="lineno">306 </span>    <span class="k">if</span><span class="p">(</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">cmp_fn</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="p">)</span>
<span class="lineno">307 </span>    <span class="p">{</span>
<span class="lineno">308 </span>      <span class="n">j</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>  <span class="c1">// 在左右结点中找到最小/最大的</span>
<span class="lineno">309 </span>    <span class="p">}</span>
<span class="lineno">310 </span>
<span class="lineno">311 </span>    <span class="k">if</span><span class="p">(</span> <span class="n">cmp_fn</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">temp</span><span class="p">)</span> <span class="p">)</span>
<span class="lineno">312 </span>    <span class="p">{</span>
<span class="lineno">313 </span>      <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">];</span> <span class="c1">// 把较小(minHeap)/较大(maxHeap)的子结点往上移动，替换父结点</span>
<span class="lineno">314 </span>      <span class="n">i</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>  <span class="c1">// 更新当前结点为父结点索引</span>
<span class="lineno">315 </span>    <span class="p">}</span>
<span class="lineno">316 </span>    <span class="k">else</span>
<span class="lineno">317 </span>    <span class="p">{</span>
<span class="lineno">318 </span>      <span class="k">break</span><span class="p">;</span>
<span class="lineno">319 </span>    <span class="p">}</span>
<span class="lineno">320 </span>  <span class="p">}</span>
<span class="lineno">321 </span>  <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">;</span>
<span class="lineno">322 </span><span class="p">}</span>
<span class="lineno">323 </span>
<span class="lineno">324 </span><span class="c1">//删除最顶端节点 </span>
<span class="lineno">325 </span><span class="kt">void</span> <span class="nf">HeapDeleteElement</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">cmp_func_t</span> <span class="n">cmp_fn</span><span class="p">)</span>
<span class="lineno">326 </span><span class="p">{</span>
<span class="lineno">327 </span>  <span class="c1">//交换</span>
<span class="lineno">328 </span>  <span class="n">Swap</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
<span class="lineno">329 </span>  <span class="c1">//删除</span>
<span class="lineno">330 </span>  <span class="n">HeapFixDown</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmp_fn</span><span class="p">);</span>
<span class="lineno">331 </span><span class="p">}</span>
<span class="lineno">332 </span>
<span class="lineno">333 </span><span class="c1">// 堆化数组建立堆</span>
<span class="lineno">334 </span><span class="kt">void</span> <span class="nf">MakeHeap</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">cmp_func_t</span> <span class="n">cmp_fn</span><span class="p">)</span>
<span class="lineno">335 </span><span class="p">{</span>
<span class="lineno">336 </span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
<span class="lineno">337 </span>  <span class="c1">// 从最后一个结点i=n-1的父节点(i-1)/2开始到root</span>
<span class="lineno">338 </span>  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span>
<span class="lineno">339 </span>    <span class="n">HeapFixDown</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">cmp_fn</span><span class="p">);</span>
<span class="lineno">340 </span><span class="p">}</span>
<span class="lineno">341 </span>
<span class="lineno">342 </span><span class="c1">// !!!最小堆排序后是递减数组，要得到递增数组，可以使用最大堆</span>
<span class="lineno">343 </span><span class="kt">void</span> <span class="nf">HeapSort</span><span class="p">(</span><span class="n">T</span> <span class="o">*</span><span class="n">arr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">cmp_func_t</span> <span class="n">cmp_fn</span><span class="p">)</span>
<span class="lineno">344 </span><span class="p">{</span>
<span class="lineno">345 </span>  <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
<span class="lineno">346 </span>  <span class="c1">//堆化数组，建立堆</span>
<span class="lineno">347 </span>  <span class="n">MakeHeap</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">cmp_fn</span><span class="p">);</span>
<span class="lineno">348 </span>  <span class="c1">// 依次删除根，置于后面的有序区间，重新调整堆，类似选择排序</span>
<span class="lineno">349 </span>  <span class="k">for</span><span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span>
<span class="lineno">350 </span>  <span class="p">{</span>
<span class="lineno">351 </span>    <span class="n">Swap</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="lineno">352 </span>    <span class="n">HeapFixDown</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">cmp_fn</span><span class="p">);</span>
<span class="lineno">353 </span>  <span class="p">}</span>
<span class="lineno">354 </span>
<span class="lineno">355 </span><span class="p">}</span>
<span class="lineno">356 </span>
<span class="lineno">357 </span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="lineno">358 </span><span class="p">{</span>
<span class="lineno">359 </span>  <span class="c1">//int a[8] = {1, 1, 1, 1, 1, 1, 1, 1};</span>
<span class="lineno">360 </span>  <span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">25</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">7</span><span class="p">};</span>
<span class="lineno">361 </span>  <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="lineno">362 </span>  <span class="n">T</span> <span class="o">*</span><span class="n">temp</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">n</span><span class="p">);</span>
<span class="lineno">363 </span>
<span class="lineno">364 </span>  <span class="n">printArr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span> 
<span class="lineno">365 </span>
<span class="lineno">366 </span>  <span class="c1">//InsertSort(a, n, cmp_bigger);</span>
<span class="lineno">367 </span>  <span class="c1">//Bubble2Sort(a, n, cmp_bigger);</span>
<span class="lineno">368 </span>  <span class="c1">//MergeSort(a, temp, 0, n-1, cmp_less);</span>
<span class="lineno">369 </span>  <span class="c1">//MergeSort2(a, temp, n, cmp_less);</span>
<span class="lineno">370 </span>  <span class="c1">//QuickSort(a, 0, n-1, cmp_bigger);</span>
<span class="lineno">371 </span>  <span class="c1">//ShellSort(a, n, cmp_less);</span>
<span class="lineno">372 </span>  <span class="n">HeapSort</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">cmp_bigger</span><span class="p">);</span>
<span class="lineno">373 </span>  <span class="n">printArr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
<span class="lineno">374 </span>  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">375 </span><span class="p">}</span>
</pre></div>
